{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/taggedTemplateLiteralLoose\";\n\nvar _templateObject,\n    _jsxFileName = \"/Users/ntommy/Projects/wisesaying/screens/Create.js\";\n\nimport React, { useEffect } from 'react';\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { useColorScheme } from 'react-native-appearance';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useForm } from 'react-hook-form';\nimport { gql, useMutation, useQuery } from '@apollo/client';\nimport { useState } from 'react';\nimport { KeyboardAwareScrollView } from 'react-native-keyboard-aware-scroll-view';\nimport AuthLayout from \"../components/auth/AuthLayout\";\nimport { SEARCH_AUTHOR, SEARCH_TAG } from \"../queries\";\nimport { useIsFocused } from '@react-navigation/core';\nvar BUTTON_COLOR = \"#0A82FF\";\nvar UPLOAD_SAYING = gql(_templateObject || (_templateObject = _taggedTemplateLiteralLoose([\"\\n  mutation uploadSaying(\\n    $text: String!,\\n    $tag: [String],\\n    $author: String!\\n  ){\\n    uploadSaying(\\n      text: $text\\n      tag: $tag\\n      author: $author\\n    ){\\n      id\\n    }\\n  }\\n\"])));\n\nfunction Tag(_ref) {\n  var name = _ref.name,\n      tags = _ref.tags,\n      setTags = _ref.setTags;\n  console.log(name);\n  return React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      setTags(function (old) {\n        return old.filter(function (item) {\n          return item != name;\n        });\n      });\n    },\n    style: css.tagWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: \"#464646\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }\n  }, name, \" \"), React.createElement(Ionicons, {\n    name: \"close\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }\n  }));\n}\n\nfunction RecommendTags(_ref2) {\n  var _this = this;\n\n  var keyword = _ref2.keyword,\n      setValue = _ref2.setValue,\n      addTag = _ref2.addTag;\n  if (keyword == undefined || keyword == \"\") return null;\n\n  var _useQuery = useQuery(SEARCH_TAG, {\n    variables: {\n      keyword: keyword.toUpperCase(),\n      take: 10\n    }\n  }),\n      data = _useQuery.data,\n      loading = _useQuery.loading,\n      error = _useQuery.error;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isCompleted = _useState2[0],\n      setIsCompleted = _useState2[1];\n\n  var close = function close() {\n    setIsCompleted(true);\n  };\n\n  if (isCompleted) return null;\n\n  if (error) {\n    console.log();\n  }\n\n  if (data) {\n    console.log(data);\n    return React.createElement(ScrollView, {\n      showsHorizontalScrollIndicator: false,\n      keyboardShouldPersistTaps: \"handled\",\n      showsHorizontalScrollIndicator: false,\n      horizontal: true,\n      style: {\n        position: 'absolute',\n        zIndex: 1,\n        width: \"100%\",\n        top: 345\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 7\n      }\n    }, data.searchTag.map(function (item, index) {\n      return React.createElement(TouchableOpacity, {\n        key: index,\n        onPress: function onPress() {\n          setValue(\"tag\", item.name);\n          addTag();\n          close();\n        },\n        style: css.recommendItem,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontWeight: \"bold\"\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 19\n        }\n      }, item.name), React.createElement(Text, {\n        style: {\n          color: \"#888888\"\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 19\n        }\n      }, \" \", item.totalSayings, \" \"));\n    }));\n  }\n\n  return null;\n}\n\nfunction RecommendAuthor(_ref3) {\n  var _this2 = this;\n\n  var keyword = _ref3.keyword,\n      setValue = _ref3.setValue,\n      darkmode = _ref3.darkmode;\n  if (keyword == undefined || keyword == \"\") return null;\n\n  var _useQuery2 = useQuery(SEARCH_AUTHOR, {\n    variables: {\n      keyword: keyword.toUpperCase(),\n      take: 10\n    }\n  }),\n      data = _useQuery2.data,\n      loading = _useQuery2.loading,\n      error = _useQuery2.error;\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isCompleted = _useState4[0],\n      setIsCompleted = _useState4[1];\n\n  var close = function close() {\n    setIsCompleted(true);\n  };\n\n  if (isCompleted) return null;\n\n  if (error) {\n    console.log();\n  }\n\n  if (data) {\n    console.log(data);\n    return React.createElement(ScrollView, {\n      showsHorizontalScrollIndicator: false,\n      keyboardShouldPersistTaps: \"handled\",\n      showsHorizontalScrollIndicator: false,\n      horizontal: true,\n      style: {\n        position: 'absolute',\n        zIndex: 1,\n        width: \"100%\",\n        top: 260\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 7\n      }\n    }, data.searchAuthor.map(function (item, index) {\n      return React.createElement(TouchableOpacity, {\n        key: index,\n        onPress: function onPress() {\n          setValue(\"author\", item.name);\n          close();\n        },\n        style: css.recommendItem,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontWeight: \"bold\"\n        },\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 19\n        }\n      }, item.name), React.createElement(Text, {\n        style: {\n          color: \"#888888\"\n        },\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 19\n        }\n      }, \" \", item.totalSayings, \" \"));\n    }));\n  }\n\n  return null;\n}\n\nfunction Subtitle(_ref4) {\n  var textColor = _ref4.textColor,\n      iconName = _ref4.iconName,\n      text = _ref4.text;\n  var iconColor = null;\n\n  switch (iconName) {\n    case \"bulb\":\n      iconColor = \"#FFD700\";\n      break;\n\n    case \"person-add\":\n      iconColor = \"#00BFFF\";\n      break;\n\n    case \"pricetags\":\n      iconColor = \"#87EEC6\";\n      break;\n  }\n\n  return React.createElement(View, {\n    style: {\n      marginTop: 10,\n      marginLeft: 5,\n      flexDirection: \"row\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 5\n    }\n  }, React.createElement(Ionicons, {\n    name: iconName,\n    size: 18,\n    color: iconColor,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }\n  }), React.createElement(Text, {\n    style: {\n      color: textColor,\n      fontSize: 18\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }\n  }, \" \", text));\n}\n\nexport default function Create(_ref5) {\n  var _this3 = this;\n\n  var navigation = _ref5.navigation;\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      setValue = _useForm.setValue,\n      getValues = _useForm.getValues,\n      watch = _useForm.watch;\n\n  var isFocused = useIsFocused();\n  var colorScheme = useColorScheme();\n  var darkmode = colorScheme === \"dark\";\n  var textColor = darkmode ? \"white\" : \"black\";\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      tags = _useState6[0],\n      setTags = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      bySelf = _useState8[0],\n      setBySelf = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      tagInput = _useState10[0],\n      setTagInput = _useState10[1];\n\n  var onCompleted = function onCompleted(data) {\n    console.log(data);\n    var id = data.uploadSaying.id;\n\n    if (id) {\n      Alert.alert(\"업로드 성공!\");\n      navigation.navigate(\"Saying\", {\n        sid: id\n      });\n    }\n  };\n\n  var onValid = function onValid(data) {\n    if (data.text.length < 5) {\n      Alert.alert(\"내용을 5자 이상 입력해주세요\");\n      return;\n    }\n\n    if (tags.length == 0) {\n      Alert.alert(\"태그를 하나 이상 추가해주세요!\");\n      return;\n    }\n\n    console.log(\"data:\", data);\n\n    if (!loading) {\n      uploadSayingMutation({\n        variables: {\n          text: data.text,\n          author: data.author,\n          tag: tags\n        }\n      });\n    }\n  };\n\n  var addTag = function addTag() {\n    var _getValues = getValues(),\n        tag = _getValues.tag;\n\n    if (tag == undefined || tag == \"\") {\n      setValue(\"tag\", \"\");\n      return;\n    }\n\n    console.log(tag);\n    setTags(function (old) {\n      return [].concat(_toConsumableArray(old), [tag]);\n    });\n    console.log(\"tags:\", tags);\n    setValue(\"tag\", \"\");\n  };\n\n  var _useMutation = useMutation(UPLOAD_SAYING, {\n    onCompleted: onCompleted\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      uploadSayingMutation = _useMutation2[0],\n      loading = _useMutation2[1].loading;\n\n  var dismissKeyboard = function dismissKeyboard() {\n    console.log(\"keyboard dismiss\");\n    Keyboard.dismiss();\n  };\n\n  useEffect(function () {\n    register(\"text\", {\n      required: true\n    });\n    register(\"tag\", {\n      required: false\n    });\n    register(\"author\", {\n      required: true\n    });\n  }, [register]);\n  console.log(watch());\n\n  if (isFocused) {\n    return React.createElement(TouchableWithoutFeedback, {\n      style: {\n        flex: 1\n      },\n      onPress: dismissKeyboard,\n      disabled: Platform.OS === \"web\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 7\n      }\n    }, React.createElement(KeyboardAwareScrollView, {\n      extraHeight: 0,\n      enableResetScrollToCoords: false,\n      keyboardShouldPersistTaps: \"handled\",\n      style: {\n        flex: 1,\n        width: \"100%\",\n        paddingHorizontal: 20,\n        paddingTop: 20,\n        backgroundColor: darkmode ? \"#111819\" : \"white\"\n      },\n      showsVerticalScrollIndicator: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }\n    }, React.createElement(View, {\n      style: {\n        backgroundColor: colorScheme === \"dark\" ? \"#111819\" : \"white\",\n        flex: 1,\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 11\n      }\n    }, React.createElement(Subtitle, {\n      textColor: textColor,\n      iconName: \"bulb\",\n      text: \"\\uB0B4\\uC6A9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 13\n      }\n    }), React.createElement(TextInput, {\n      multiline: true,\n      placeholder: \"\\uB0B4\\uC6A9\\uC744 \\uC785\\uB825\\uD558\\uC138\\uC694.\",\n      placeholderTextColor: darkmode ? \"#878787\" : \"#cdcdcd\",\n      onChangeText: function onChangeText(text) {\n        return setValue(\"text\", text);\n      },\n      style: css.textInput(textColor, darkmode),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 13\n      }\n    }), React.createElement(Subtitle, {\n      textColor: textColor,\n      iconName: \"person-add\",\n      text: \"\\uC791\\uC790\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 13\n      }\n    }), React.createElement(View, {\n      style: {\n        flex: 1,\n        flexDirection: 'row'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 13\n      }\n    }, React.createElement(TextInput, {\n      value: watch(\"author\"),\n      multiline: false,\n      onChangeText: function onChangeText(text) {\n        return setValue(\"author\", text);\n      },\n      style: css.authorInput(textColor, darkmode),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 15\n      }\n    }), React.createElement(TouchableOpacity, {\n      style: css.bySelfContainer,\n      onPress: function onPress() {\n        return setBySelf(!bySelf);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 15\n      }\n    }, React.createElement(Ionicons, {\n      name: bySelf ? \"checkmark-circle\" : \"checkmark-circle-outline\",\n      size: 28,\n      color: bySelf ? \"#1E96FF\" : \"#ababab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 17\n      }\n    }), React.createElement(Text, {\n      style: {\n        color: bySelf ? textColor : \"#ababab\",\n        fontSize: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 17\n      }\n    }, \"\\uBCF8\\uC778\"))), React.createElement(RecommendAuthor, {\n      keyword: watch(\"author\"),\n      setValue: setValue,\n      darkmode: darkmode,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 13\n      }\n    }), React.createElement(RecommendTags, {\n      keyword: watch(\"tag\"),\n      setValue: setValue,\n      addTag: addTag,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 13\n      }\n    }), React.createElement(Subtitle, {\n      textColor: textColor,\n      iconName: \"pricetags\",\n      text: \"\\uD0DC\\uADF8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 13\n      }\n    }), React.createElement(View, {\n      style: {\n        flex: 1,\n        flexDirection: 'row'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 13\n      }\n    }, React.createElement(TextInput, {\n      value: watch(\"tag\"),\n      onChangeText: function onChangeText(text) {\n        setValue(\"tag\", text);\n        setTagInput(text);\n      },\n      onSubmitEditing: function onSubmitEditing() {\n        return addTag();\n      },\n      style: css.authorInput(textColor, darkmode),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 15\n      }\n    }), React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        return addTag();\n      },\n      style: {\n        flex: 2,\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        borderColor: BUTTON_COLOR,\n        borderWidth: 1,\n        borderRadius: 5,\n        marginLeft: 10,\n        marginVertical: 10,\n        flexDirection: \"row\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 15\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: BUTTON_COLOR,\n        fontWeight: \"bold\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 17\n      }\n    }, \"\\uCD94\\uAC00\"), React.createElement(Ionicons, {\n      name: \"add\",\n      color: BUTTON_COLOR,\n      size: 18,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 17\n      }\n    }))), React.createElement(ScrollView, {\n      showsHorizontalScrollIndicator: false,\n      horizontal: true,\n      bounces: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 13\n      }\n    }, tags.map(function (name, index) {\n      return React.createElement(Tag, {\n        key: index,\n        name: name,\n        setTags: setTags,\n        tags: tags,\n        __self: _this3,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 42\n        }\n      });\n    })), React.createElement(TouchableOpacity, {\n      onPress: handleSubmit(onValid),\n      style: css.submitButton,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: \"white\",\n        fontSize: 18,\n        fontWeight: \"bold\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 15\n      }\n    }, \"\\uC644\\uB8CC\")))));\n  } else {\n    return React.createElement(View, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 12\n      }\n    });\n  }\n}\nvar css = StyleSheet.create({\n  tagWrapper: {\n    borderWidth: 0,\n    borderRadius: 15,\n    paddingVertical: 5,\n    paddingHorizontal: 10,\n    marginLeft: 5,\n    backgroundColor: \"#eeeeee\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  textInput: function textInput(textColor, darkmode) {\n    return {\n      backgroundColor: \"rgba(255,255,255,0.05)\",\n      borderWidth: 1,\n      borderColor: darkmode ? \"transparent\" : \"#cdcdcd\",\n      paddingRight: 15,\n      height: 200,\n      color: textColor,\n      borderRadius: 7,\n      paddingVertical: 5,\n      fontSize: 20,\n      marginVertical: 10,\n      paddingHorizontal: 10\n    };\n  },\n  authorInput: function authorInput(textColor, darkmode) {\n    return {\n      backgroundColor: \"rgba(255,255,255,0.05)\",\n      flex: 7,\n      borderWidth: 1,\n      borderColor: darkmode ? \"transparent\" : \"#cdcdcd\",\n      paddingRight: 15,\n      color: textColor,\n      borderRadius: 7,\n      paddingVertical: 5,\n      fontSize: 20,\n      marginVertical: 10,\n      paddingHorizontal: 10\n    };\n  },\n  tagInput: function tagInput(textColor) {\n    return {\n      flex: 7,\n      borderBottomWidth: 1,\n      borderColor: textColor,\n      paddingRight: 15,\n      color: textColor,\n      paddingVertical: 5,\n      fontSize: 20,\n      marginVertical: 10\n    };\n  },\n  bySelfContainer: {\n    flex: 2,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginLeft: 10\n  },\n  submitButton: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    backgroundColor: BUTTON_COLOR,\n    marginHorizontal: 120,\n    padding: 10,\n    borderRadius: 25,\n    marginTop: 40,\n    marginBottom: 50\n  },\n  recommendItem: {\n    backgroundColor: \"#dedede\",\n    borderRadius: 5,\n    padding: 5,\n    marginRight: 5,\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"sources":["/Users/ntommy/Projects/wisesaying/screens/Create.js"],"names":["React","useEffect","useColorScheme","Ionicons","useForm","gql","useMutation","useQuery","useState","KeyboardAwareScrollView","AuthLayout","SEARCH_AUTHOR","SEARCH_TAG","useIsFocused","BUTTON_COLOR","UPLOAD_SAYING","Tag","name","tags","setTags","console","log","old","filter","item","css","tagWrapper","color","RecommendTags","keyword","setValue","addTag","undefined","variables","toUpperCase","take","data","loading","error","isCompleted","setIsCompleted","close","position","zIndex","width","top","searchTag","map","index","recommendItem","fontWeight","totalSayings","RecommendAuthor","darkmode","searchAuthor","Subtitle","textColor","iconName","text","iconColor","marginTop","marginLeft","flexDirection","fontSize","Create","navigation","register","handleSubmit","getValues","watch","isFocused","colorScheme","bySelf","setBySelf","tagInput","setTagInput","onCompleted","id","uploadSaying","Alert","alert","navigate","sid","onValid","length","uploadSayingMutation","author","tag","dismissKeyboard","Keyboard","dismiss","required","flex","Platform","OS","paddingHorizontal","paddingTop","backgroundColor","textInput","authorInput","bySelfContainer","alignItems","justifyContent","borderColor","borderWidth","borderRadius","marginVertical","submitButton","StyleSheet","create","paddingVertical","paddingRight","height","borderBottomWidth","marginHorizontal","padding","marginBottom","marginRight"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { ScrollView, Text, View ,TouchableOpacity, TextInput, TouchableWithoutFeedback,KeyboardAvoidingView, Keyboard, Alert,StyleSheet } from \"react-native\"\nimport { useColorScheme } from 'react-native-appearance';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useForm } from 'react-hook-form';\nimport { gql, useMutation, useQuery } from '@apollo/client';\nimport { useState } from 'react';\nimport { KeyboardAwareScrollView } from 'react-native-keyboard-aware-scroll-view';\nimport AuthLayout from '../components/auth/AuthLayout';\nimport { SEARCH_AUTHOR, SEARCH_TAG } from '../queries';\nimport { useIsFocused } from '@react-navigation/core';\n\nconst BUTTON_COLOR = \"#0A82FF\"\n\nconst UPLOAD_SAYING = gql`\n  mutation uploadSaying(\n    $text: String!,\n    $tag: [String],\n    $author: String!\n  ){\n    uploadSaying(\n      text: $text\n      tag: $tag\n      author: $author\n    ){\n      id\n    }\n  }\n`\nfunction Tag({name,tags,setTags}){\n  console.log(name);\n  return (\n    <TouchableOpacity \n      onPress={()=>{\n        setTags(old=>old.filter((item)=>item!=name));\n      }}\n      style={css.tagWrapper}\n    >\n      <Text style={{color:\"#464646\"}}>{name} </Text>\n      <Ionicons name=\"close\"/>\n    </TouchableOpacity>\n  )\n}\nfunction RecommendTags({keyword,setValue,addTag}){\n  if(keyword==undefined || keyword==\"\") return null;\n\n  const {data,loading,error} = useQuery(SEARCH_TAG,{\n    variables:{\n      keyword:keyword.toUpperCase(),\n      take: 10\n    }\n  });\n\n  const [isCompleted, setIsCompleted] = useState(false);\n  const close = ()=>{\n    setIsCompleted(true);\n  }\n  if(isCompleted) return null;\n\n  if(error){\n    console.log()\n  }\n  if(data){\n    console.log(data);\n    return(\n      <ScrollView\n        showsHorizontalScrollIndicator={false}\n        keyboardShouldPersistTaps=\"handled\"\n        showsHorizontalScrollIndicator={false}\n        horizontal={true} \n        style={{\n          position:'absolute',\n          zIndex:1,  \n          width:\"100%\",\n          top:345,\n        }}>\n          {\n            data.searchTag.map((item,index)=>{\n              return(\n                <TouchableOpacity \n                  key={index} \n                  onPress={()=>{\n                    setValue(\"tag\",item.name)\n                    addTag();\n                    close();\n                  }}\n                  style={css.recommendItem}>\n                  <Text style={{fontWeight:\"bold\"}}>{item.name}</Text>\n                  <Text style={{color:\"#888888\"}}> {item.totalSayings} </Text>\n                </TouchableOpacity>\n              )\n            })\n          }\n      </ScrollView>\n    )\n  }\n  return null;\n}\nfunction RecommendAuthor({keyword,setValue, darkmode}){\n  if(keyword==undefined || keyword==\"\") return null;\n\n  const {data,loading,error} = useQuery(SEARCH_AUTHOR,{\n    variables:{\n      keyword:keyword.toUpperCase(),\n      take: 10\n    }\n  });\n\n  const [isCompleted, setIsCompleted] = useState(false);\n  const close = ()=>{\n    setIsCompleted(true);\n  }\n  if(isCompleted) return null;\n\n  if(error){\n    console.log()\n  }\n  if(data){\n    console.log(data);\n    return(\n      <ScrollView\n        showsHorizontalScrollIndicator={false}\n        keyboardShouldPersistTaps=\"handled\"\n        showsHorizontalScrollIndicator={false}\n        horizontal={true} \n        style={{\n          position:'absolute',\n          zIndex:1,  \n          width:\"100%\",\n          top:260,\n        }}>\n          {\n            data.searchAuthor.map((item,index)=>{\n              return(\n                <TouchableOpacity \n                  key={index} \n                  onPress={()=>{\n                    setValue(\"author\",item.name)\n                    close();\n                  }}\n                  style={css.recommendItem}>\n                  <Text style={{fontWeight:\"bold\"}}>{item.name}</Text>\n                  <Text style={{color:\"#888888\"}}> {item.totalSayings} </Text>\n                </TouchableOpacity>\n              )\n            })\n          }\n      </ScrollView>\n    )\n  }\n  return null;\n}\n\nfunction Subtitle({textColor,iconName,text}){\n  let iconColor = null;\n  switch(iconName){\n    case \"bulb\": iconColor = \"#FFD700\"; break;\n    case \"person-add\": iconColor = \"#00BFFF\"; break;\n    case \"pricetags\": iconColor = \"#87EEC6\"; break;\n  }\n  return(\n    <View style={{\n      marginTop: 10,\n      marginLeft: 5,\n      flexDirection:\"row\"\n    }}>\n      <Ionicons name={iconName} size={18} color={iconColor}/>\n      <Text style={{\n        color: textColor,\n        fontSize: 18\n      }}> {text}</Text>\n    </View>\n  )\n}\n\nexport default function Create({navigation}){\n  const {register, handleSubmit, setValue, getValues, watch} = useForm();\n  const isFocused = useIsFocused();\n  const colorScheme = useColorScheme();\n  const darkmode = colorScheme===\"dark\";\n  const textColor = darkmode?\"white\":\"black\";\n  const [tags, setTags] = useState([]);\n  const [bySelf, setBySelf] = useState(false);\n  const [tagInput, setTagInput] = useState(\"\");\n\n\n  const onCompleted = (data)=>{\n    console.log(data);\n    const {uploadSaying:{id}} = data; // UNZIP result data\n    if(id){\n      Alert.alert(\"업로드 성공!\");\n      navigation.navigate(\"Saying\",{\n        sid: id,\n      });\n    }\n  }\n\n  const onValid = (data)=>{\n    if(data.text.length<5){\n      Alert.alert(\"내용을 5자 이상 입력해주세요\");\n      return;\n    }\n    if(tags.length==0){\n      Alert.alert(\"태그를 하나 이상 추가해주세요!\");\n      return;\n    }\n    console.log(\"data:\",data);\n    if(!loading){\n      uploadSayingMutation({\n        variables:{\n          text:data.text,\n          author:data.author,\n          tag:tags\n        }\n      })\n    }\n\n  }\n\n  const addTag = ()=>{\n    const {tag} = getValues();\n    if (tag==undefined || tag==\"\"){\n      setValue(\"tag\",\"\")\n      return;\n    } \n    \n    console.log(tag);\n    setTags(old=>[...old,tag]);\n    console.log(\"tags:\",tags);\n    setValue(\"tag\",\"\");\n  }\n  const [uploadSayingMutation, {loading}] = useMutation(UPLOAD_SAYING,{\n    onCompleted,\n  })\n\n  const dismissKeyboard = ()=>{\n    console.log(\"keyboard dismiss\");\n    Keyboard.dismiss();\n  }\n\n  useEffect(()=>{\n    register(\"text\",{\n      required: true,\n    });\n    register(\"tag\",{\n      required:false,\n    });\n    register(\"author\",{\n      required: true,\n    });\n  },[register])\n  console.log(watch());\n  if(isFocused){\n    return(\n      <TouchableWithoutFeedback style={{ flex: 1 }} onPress={dismissKeyboard} disabled={Platform.OS===\"web\"}>\n        \n        <KeyboardAwareScrollView\n          extraHeight={0}\n          enableResetScrollToCoords={false}\n          keyboardShouldPersistTaps=\"handled\"\n          style={{flex:1, width:\"100%\", paddingHorizontal:20, paddingTop: 20, backgroundColor:darkmode?\"#111819\":\"white\"}} \n          showsVerticalScrollIndicator={false}\n        >\n        \n        {/*\n          <ScrollView         \n            keyboardShouldPersistTaps=\"handled\"\n            style={{flex:1, width:\"100%\", paddingHorizontal:20, paddingTop: 20}} \n            showsVerticalScrollIndicator={false}>\n        <KeyboardAvoidingView behavior=\"padding\" enabled style={{flex:1, width:\"100%\", borderWidth:0,borderColor:\"red\"}}> \n        */}\n          <View style={{\n            backgroundColor:colorScheme===\"dark\"?\"#111819\":\"white\", \n            flex:1, \n            width:\"100%\"\n          }}>\n            <Subtitle textColor={textColor} iconName=\"bulb\" text=\"내용\"/>\n            <TextInput \n              multiline={true}\n              placeholder=\"내용을 입력하세요.\"\n              placeholderTextColor={darkmode?\"#878787\":\"#cdcdcd\"}\n              onChangeText={(text)=>setValue(\"text\",text)}\n              style={css.textInput(textColor,darkmode)}  \n            />\n            <Subtitle textColor={textColor} iconName=\"person-add\" text=\"작자\"/>\n            <View style={{\n              flex:1,\n              flexDirection: 'row'\n            }}>\n              <TextInput \n                value={watch(\"author\")}\n                multiline={false}\n                onChangeText={(text)=>setValue(\"author\",text)}\n                style={css.authorInput(textColor,darkmode)}\n              />\n              <TouchableOpacity \n                style={css.bySelfContainer}\n                onPress={()=>setBySelf(!bySelf)}\n              >\n                <Ionicons \n                  name={bySelf?\"checkmark-circle\":\"checkmark-circle-outline\" }\n                  size={28} \n                  color={bySelf?\"#1E96FF\":\"#ababab\"}/>\n                <Text style={{\n                  color: bySelf?textColor:\"#ababab\",\n                  fontSize: 20\n                }}>본인</Text>\n              </TouchableOpacity>\n            </View>\n            <RecommendAuthor keyword={watch(\"author\")} setValue={setValue} darkmode={darkmode}/>\n            <RecommendTags keyword={watch(\"tag\")} setValue={setValue} addTag={addTag}/>\n            <Subtitle textColor={textColor} iconName=\"pricetags\" text=\"태그\"/>\n            <View style={{\n              flex:1,\n              flexDirection: 'row'\n            }}>\n              <TextInput \n                value={watch(\"tag\")}\n                onChangeText={(text)=>{\n                  setValue(\"tag\",text);\n                  setTagInput(text);\n                }}\n                onSubmitEditing={()=>addTag()}\n                style={css.authorInput(textColor,darkmode)}\n              />\n              <TouchableOpacity \n                onPress={()=>addTag()}\n                style={{\n                  flex:2, \n                  alignItems:\"center\", \n                  justifyContent:\"center\", \n                  borderColor:BUTTON_COLOR,\n                  borderWidth:1,\n                  borderRadius:5,\n                  marginLeft: 10,\n                  marginVertical : 10,\n                  flexDirection:\"row\"\n                  }}\n                >\n                <Text style={{color:BUTTON_COLOR, fontWeight:\"bold\"}}>추가</Text>\n                <Ionicons name=\"add\" color={BUTTON_COLOR} size={18}/>\n              </TouchableOpacity>\n            </View>\n            <ScrollView showsHorizontalScrollIndicator={false} horizontal={true} bounces={true}>\n                {\n                  tags.map((name,index)=><Tag key={index} name={name} setTags={setTags} tags={tags}/>)\n                }\n              </ScrollView>\n            <TouchableOpacity \n              onPress={handleSubmit(onValid)}\n              style={css.submitButton}\n            >\n              <Text style={{color:\"white\", fontSize:18, fontWeight:\"bold\"}}>완료</Text>\n            </TouchableOpacity>\n          </View>\n          {/*\n          </KeyboardAvoidingView>\n          </ScrollView>*/}\n          \n            </KeyboardAwareScrollView>\n          \n    </TouchableWithoutFeedback>\n    )\n  }else{\n    return <View></View>\n  }\n}\n\nconst css = StyleSheet.create({\n  tagWrapper:{\n    borderWidth: 0,\n    borderRadius: 15,\n    paddingVertical: 5,\n    paddingHorizontal: 10,\n    marginLeft: 5,\n    backgroundColor: \"#eeeeee\",\n    flexDirection:\"row\",   \n    alignItems:\"center\",\n    justifyContent:\"center\" \n  },\n  textInput:(textColor,darkmode)=>({\n    backgroundColor: \"rgba(255,255,255,0.05)\",\n    borderWidth: 1,\n    borderColor: darkmode?\"transparent\":\"#cdcdcd\",\n    paddingRight: 15,\n    height: 200,\n    color: textColor,\n    borderRadius:7,\n    paddingVertical: 5,\n    fontSize: 20,\n    marginVertical: 10,\n    paddingHorizontal: 10\n  }),\n  authorInput:(textColor,darkmode)=>({\n    backgroundColor: \"rgba(255,255,255,0.05)\",\n    flex: 7,\n    borderWidth: 1,\n    borderColor: darkmode?\"transparent\":\"#cdcdcd\",\n    paddingRight: 15,\n    color: textColor,\n    borderRadius:7,\n    paddingVertical: 5,\n    fontSize: 20,\n    marginVertical: 10,\n    paddingHorizontal: 10\n  }),\n  tagInput:textColor=>({\n    flex: 7,\n    borderBottomWidth: 1,\n    borderColor: textColor,\n    paddingRight: 15,\n    color: textColor,\n    paddingVertical: 5,\n    fontSize: 20,\n    marginVertical: 10,\n  }),\n  bySelfContainer:{\n    flex:2,\n    flexDirection: \"row\",\n    alignItems:\"center\",\n    marginLeft:10,\n  },\n  submitButton:{\n    alignItems:\"center\", \n    justifyContent:\"center\",\n    backgroundColor:BUTTON_COLOR,\n    marginHorizontal: 120,\n    padding: 10, \n    borderRadius: 25,\n    marginTop: 40,\n    marginBottom: 50,\n  },\n  recommendItem:{\n    backgroundColor:\"#dedede\",\n    borderRadius:5,\n    padding: 5,\n    marginRight: 5,\n    flexDirection:\"row\",\n    alignItems:\"center\"\n  }\n})\n"]},"metadata":{},"sourceType":"module"}